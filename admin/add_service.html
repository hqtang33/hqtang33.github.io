<!DOCTYPE HTML>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Stamina &mdash; Free Website Template, Free HTML5 Template by freehtml5.co</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Free HTML5 Website Template by freehtml5.co" />
  <meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
  <meta name="author" content="freehtml5.co" />

  <!--
	//////////////////////////////////////////////////////

	FREE HTML5 TEMPLATE
	DESIGNED & DEVELOPED by FreeHTML5.co

	Website: 		http://freehtml5.co/
	Email: 			info@freehtml5.co
	Twitter: 		http://twitter.com/fh5co
	Facebook: 		https://www.facebook.com/fh5co

	//////////////////////////////////////////////////////
	 -->

  <!-- Facebook and Twitter integration -->
  <meta property="og:title" content="" />
  <meta property="og:image" content="" />
  <meta property="og:url" content="" />
  <meta property="og:site_name" content="" />
  <meta property="og:description" content="" />
  <meta name="twitter:title" content="" />
  <meta name="twitter:image" content="" />
  <meta name="twitter:url" content="" />
  <meta name="twitter:card" content="" />

  <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,500,700,800" rel="stylesheet">

  <!-- Animate.css -->
  <link rel="stylesheet" href="/css/animate.css">
  <!-- Font Awesome -->
  <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <!-- Icomoon Icon Fonts-->
  <link rel="stylesheet" href="/css/icomoon.css">
  <!-- Bootstrap  -->
  <link rel="stylesheet" href="/bootstrap/css/bootstrap.css">

  <!-- Magnific Popup -->
  <link rel="stylesheet" href="/css/magnific-popup.css">

  <!-- Owl Carousel  -->
  <link rel="stylesheet" href="/css/owl.carousel.min.css">
  <link rel="stylesheet" href="/css/owl.theme.default.min.css">

  <!-- Theme style  -->
  <link rel="stylesheet" href="/css/style.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/custom.css">

  <!-- Modernizr JS -->
  <script src="/js/modernizr-2.6.2.min.js"></script>
  <!-- FOR IE9 below -->
  <!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
  <!-- Admin Page CSS -->
  <link rel="stylesheet" href="../css/admin.css">

</head>

<body>

  <div class="fh5co-loader"></div>

  <div id="page">
    <nav id="header" class="fh5co-nav" role="navigation"></nav>

    <nav class="setting-nav">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 text-center setting-title">
            <p>Settings</p>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 text-center menu-2">
            <ul class="list-inline">
              <li><a href="setting_schedule.html">Schedule</a></li>
              <li><a href="setting_profile.html">Website Profile</a></li>
              <li><a href="setting_account.html">Create Account</a></li>
              <li><a href="pricing_plan.html">Modify Plan</a></li>
              <li><a href="notification.html">Feedback</a></li>
              <li class="active"><a href="add_service.html">Add Service</a></li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <div class="setting-content">
      <div class="container">
        <div class="form-group pull-right">
          <button href="#add-service-popup" type="button" id="bt" class="btn btn-primary btn-square add-service-popup">Add Service</button>
        </div>
        <table id="classTable" class="table table-bordered" width="100%">
          <tr>
            <th width="15%">Class ID</th>
            <th width="30%">Class Name</th>
            <th width="45%">Description</th>
            <th width="10%">Action</th>

          </tr>









        </table>

      </div>

    </div>

    <div id="footer"></div>

    <!--- Popup Content --->
    <!--- Add service --->
    <div id="add-service-popup" class="white-popup white-popup-md mfp-hide">
      <h2 class="title-field" style="text-decoration:none;">Add service</h2>
      <form id="add-service-form">
        <div class="row form-group">
          <div class="col-md-12">
            <label>ID</label>
            <input type="text" id="js-class-id" class="form-control" placeholder="Class ID">
          </div>
        </div>
        <div class="row form-group">
          <div class="col-md-12">
            <label>Name</label>
            <input type="text" id="js-class-name" class="form-control" placeholder="Class Name">
          </div>
        </div>
        <div class="row form-group">
          <div class="col-md-12">
            <label>Description</label>
            <textarea id="js-class-desc" rows="5" class="form-control" placeholder="Describe about the class."></textarea>
          </div>
        </div>
        <div class="row form-group">
          <div class="col-md-12">
            <label>Class Picture</label>
            <input type="file" accept="image/*" id="js-class-picture">
          </div>

          <div class="col-md-12">
            <br><img id="display-class-picture" src="" class="img-responsive">
          </div>
        </div>
        <div id="success-in-popup" class="alert alert-success" hidden></div>
        <div class="form-group">
          <button type="button" id="btn-upload" class="btn btn-primary">Upload</button>
          <button type="button" id="btn-add-service" class="btn btn-primary">Submit</button>
        </div>
      </form>


    </div>

    <!--- Edit service --->
    <div id="edit-service-popup" class="white-popup white-popup-md mfp-hide">
      <h2 class="title-field" style="text-decoration:none;">Edit service</h2>
      <form id="edit-service-form">
        <div class="row form-group">
          <div class="col-md-12">
            <label>Class ID</label>
            <input type="text" id="js-class-id" class="form-control" placeholder="Class ID">
          </div>
        </div>
        <div class="row form-group">
          <div class="col-md-12">
            <label>Name</label>
            <input type="text" id="js-class-name" class="form-control" placeholder="Class Name">
          </div>
        </div>
        <div class="row form-group">
          <div class="col-md-12">
            <label>Description</label>
            <textarea id="js-class-desc" rows="5" class="form-control" placeholder="Describe about the class."></textarea>
          </div>
        </div>
        <div class="row form-group">
          <div class="col-md-12">
            <label>Class Picture</label>
            <input type="file" accept="image/*" id="js-class-picture">
          </div>
        </div>
        <img class="img-responsive" src="https://firebasestorage.googleapis.com/v0/b/uccd2223-may-2017.appspot.com/o/class_picture%2FBX-Basic_img.jpg?alt=media&token=960c68c6-26f7-4577-90d7-ad44b863ce3f" alt="">
        <div class="form-group">
          <button type="button" id="btn-upload" class="btn btn-primary">Upload picture</button>
          <button type="button" id="btn-add-service" class="btn btn-primary">Confirm</button>
        </div>
      </form>


    </div>
  </div>

  <div class="gototop js-top">
    <a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
  </div>

  <!-- jQuery -->
  <script src="/js/jquery.min.js"></script>
  <!-- jQuery Easing -->
  <script src="/js/jquery.easing.1.3.js"></script>
  <!-- Bootstrap -->
  <script src="/js/bootstrap.min.js"></script>
  <!-- Waypoints -->
  <script src="/js/jquery.waypoints.min.js"></script>
  <!-- Stellar Parallax -->
  <script src="/js/jquery.stellar.min.js"></script>
  <!-- Carousel -->
  <script src="/js/owl.carousel.min.js"></script>
  <!-- countTo -->
  <script src="/js/jquery.countTo.js"></script>
  <!-- Magnific Popup -->
  <script src="/js/jquery.magnific-popup.min.js"></script>
  <script src="/js/magnific-popup-options.js"></script>
  <script type="text/javascript">
    $(function() {
      $("#header").load("/header.html");
      $("#footer").load("/footer.html");
    });
  </script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>
  <!-- Main -->
  <script src="/js/main.js"></script>
  <!-- Custom -->
  <script src="/js/custom.js"></script>
  <script type="text/javascript">
    $(function() {

      $("#js-acc-level").change(function() {
        if ($(this).val() == "2") {
          $("#trainer-exe").show();
        } else {
          $("#trainer-exe").hide();
        }
      });

      var classInfoRef = firebase.database().ref("/class_Info/");
      classInfoRef.on('child_added', function(data) {
        var newClass = data.val();
        $("#classTable").append("<tr id=\"" + newClass.classID + "\"><td>" + newClass.classID +
          "</td><td>" + newClass.className + "</td><td>" + newClass.classDesc +
          "</td><td><button id=\"btn-delete\" type=\"button\" class=\"btn btn-primary btn-square\">Delete</button></td></tr>"
        );
      });
      firebase.database().ref('/class_Info/').on("child_removed", function(data) {
        var removedClass = data.val();
        $("#" + removedClass.classID).remove();
      });



      $(document.body).on('click', "table button", function() {
        var classID = $(this).closest('tr').attr('id');
        var classInfoRef = firebase.database().ref("/class_Info/");
        classInfoRef.child(classID).remove();
      });



      $('.add-service-popup').magnificPopup({
        type: 'inline',
        midClick: true, // Allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source in href.
        callbacks: {
          open: function() {
            $("#btn-upload").on("click", function() {
              var classes = new Object();
              classes.classID = $('#js-class-id').val();
              classes.className = $('#js-class-name').val();
              classes.classDesc = $('#js-class-desc').val();
              var file = $("#js-class-picture")[0].files[0];
              var ext = getExtension(file.name);
              firebase.storage().ref('class_picture/' + classes.classID + '_img.' + ext).put(file).then(function(snapshot) {

                classes.classPic = snapshot.downloadURL;
                $("#display-class-picture").attr("src", classes.classPic);
                $("#btn-add-service").on('click', function() {
                  updates = {};
                  updates['/class_Info/' + classes.classID] = classes;
                  firebase.database().ref().update(updates).then(function() {
                    $("#success-in-popup").text("New Service Added!").fadeIn();
                    setTimeout(function() {
                      $("#success-message").fadeOut();
                    }, 1500);
                    $('#add-service-form').trigger("reset");
                    $("#display-class-picture").attr("src", "");
                  });
                });

              });


            });
          },
          close: function() {
            // Will fire when popup is closed
            $('#add-service-form').trigger("reset");
          }
        }
      });

      $('.edit-service-popup').magnificPopup({
        type: 'inline',
        midClick: true, // Allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source in href.
        callbacks: {
          open: function() {
            /*--- Trainer Gather ---*/
            var database = firebase.database().ref('/account_Info/');
            database.once('value', function(data) {
              var account_Info = data.val();
              /* --- console.log(account_Info); ---*/
              var keys = Object.keys(account_Info);

              for (var i = 0; i < keys.length; i++) {
                var t = keys[i];
                var acc_level = account_Info[t].acc_level;
                if (acc_level == 2) {
                  $("#js-handled-trainer").append("<option value=\"" + account_Info[t].userId + "\">" +
                    account_Info[t].fname + " " + account_Info[t].lname + "</option>");
                }
              }
            });

            var classInfoRef = firebase.database().ref('/class_Info/');

            $("#btn-upload").on("click", function() {
              var classes = new Object();
              classes.classID = $('#js-class-id').val();
              classes.className = $('#js-class-name').val();
              classes.handledBy = $('#js-handled-trainer').val();
              classes.classDesc = $('#js-class-desc').val();
              var file = $("#js-class-picture")[0].files[0];
              firebase.storage().ref('class_picture/' + classes.classID + '_img.jpg').put(file).then(function(snapshot) {

                classes.classPic = snapshot.downloadURL;
                $("#display-class-picture").attr("src", classes.classPic);
                $("#btn-add-service").on('click', function() {
                  updates = {};
                  updates['/class_Info/' + classes.classID] = classes;
                  firebase.database().ref().update(updates).then(function() {

                  });
                });

              });


            });
          },
          close: function() {
            // Will fire when popup is closed
            $('#add-service-form').trigger("reset");
          }
        }
      });
    });

    function thisTest() {
      $.magnificPopup.open({
        items: {
          type: 'inline',
          midClick: true,
          callbacks: {
            open: function() {
              /*--- Trainer Gather ---*/
              var database = firebase.database().ref('/account_Info/');
              database.once('value', function(data) {
                var account_Info = data.val();
                /* --- console.log(account_Info); ---*/
                var keys = Object.keys(account_Info);

                for (var i = 0; i < keys.length; i++) {
                  var t = keys[i];
                  var acc_level = account_Info[t].acc_level;
                  if (acc_level == 2) {
                    $("#js-handled-trainer").append("<option value=\"" + account_Info[t].userId + "\">" +
                      account_Info[t].fname + " " + account_Info[t].lname + "</option>");
                  }
                }
              });

              var classInfoRef = firebase.database().ref('/class_Info/');

              $("#btn-upload").on("click", function() {
                var classes = new Object();
                classes.classID = $('#js-class-id').val();
                classes.className = $('#js-class-name').val();
                classes.handledBy = $('#js-handled-trainer').val();
                classes.classDesc = $('#js-class-desc').val();
                var file = $("#js-class-picture")[0].files[0];
                firebase.storage().ref('class_picture/' + classes.classID + '_img.jpg').put(file).then(function(snapshot) {

                  classes.classPic = snapshot.downloadURL;
                  $("#display-class-picture").attr("src", classes.classPic);
                  $("#btn-add-service").on('click', function() {
                    updates = {};
                    updates['/class_Info/' + classes.classID] = classes;
                    firebase.database().ref().update(updates).then(function() {

                    });
                  });

                });


              });
            },
            close: function() {
              // Will fire when popup is closed
              $('#add-service-form').trigger("reset");
            }
          }
        }
      });
    }

    function getExtension(filename) {
      var parts = filename.split('.');
      return parts[parts.length - 1];
    }
  </script>



</body>

</html>
